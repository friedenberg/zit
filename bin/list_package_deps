#! /bin/bash -e

print_matches() (
	path="$1"
	ag 'github.com/friedenberg/zit/\w+' \
		--only-matching \
		--no-file \
		--no-color \
		--no-group \
		--no-break \
		"$path"
)

print_basenames() (
	while IFS= read -r; do
		basename "$REPLY"
	done
)

print_packge_locations() (
  loc="$1"
	while IFS= read -r; do
    echo "$REPLY"
		ag "github.com/friedenberg/zit/$REPLY" "$loc" -l0 </dev/null \
      | xargs -0 dirname \
      | sort -u
	done
)

print_matches "$1" |
	print_basenames |
	sort -u |
	print_packge_locations "$1"
